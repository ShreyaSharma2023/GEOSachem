esma_set_this ()

set (kpp_gas_dir kpp/gas)
set (srcs
  ${kpp_gas_dir}/kpp_achem_gas_Precision.f90
  ${kpp_gas_dir}/kpp_achem_gas_Parameters.f90
  ${kpp_gas_dir}/kpp_achem_gas_Global.f90
  ${kpp_gas_dir}/kpp_achem_gas_Function.f90
  ${kpp_gas_dir}/kpp_achem_gas_JacobianSP.f90
  ${kpp_gas_dir}/kpp_achem_gas_Jacobian.f90
  ${kpp_gas_dir}/kpp_achem_gas_HessianSP.f90
  ${kpp_gas_dir}/kpp_achem_gas_Hessian.f90
  ${kpp_gas_dir}/kpp_achem_gas_StoichiomSP.f90
  ${kpp_gas_dir}/kpp_achem_gas_Stoichiom.f90
  ${kpp_gas_dir}/kpp_achem_gas_Rates.f90
  ${kpp_gas_dir}/kpp_achem_gas_Monitor.f90
  ${kpp_gas_dir}/kpp_achem_gas_Util.f90
  ${kpp_gas_dir}/kpp_achem_gas_LinearAlgebra.f90
  ${kpp_gas_dir}/kpp_achem_gas_Integrator.f90
  GACL_ConstantsMod.F90
  GACL_EmissionsMod.F90
  GACL_ReactionRatesMod.F90
  GACL_DryDepositionMod.F90
  Chem_ConstMod.F90
  DryDepositionMod.F90
  GEOSachem_GridCompMod.F90
  )

esma_add_library (
  ${this}
  SRCS ${srcs}
  DEPENDENCIES MAPL GMAO_mpeu esmf NetCDF::NetCDF_Fortran
  )
target_compile_definitions (${this} PRIVATE MAPL_MODE GEOS5)
set_target_properties (${this} PROPERTIES COMPILE_FLAGS ${PP})

new_esma_generate_automatic_code (
  ${this} GEOSachem_Registry.rc
  "GEOSachem_ExportSpec___.h;GEOSachem_GetPointer___.h"
  GEOSachem_History___.rc
  ${include_GEOSachem} ${esma_etc}
  "-f"
  )

file (GLOB_RECURSE rc_files CONFIGURE_DEPENDS RELATIVE ${CMAKE_CURRENT_SOURCE_DIR} *.rc *.yaml)
foreach ( file ${rc_files} )
   get_filename_component( dir ${file} DIRECTORY )
   install( FILES ${file} DESTINATION etc/${dir} )
endforeach()

Add_library(GEOSachem_GridComp STATIC
	GEOSachem_GridCompMod.F90
)
target_link_libraries(GEOSachem_GridComp PUBLIC GeosCore)

